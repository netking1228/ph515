<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta name="robots" content="noindex, nofollow">
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>åœ–ç‰‡è³‡æ–™åº«ï½œGallery</title>
  <!-- âœ… Bootstrap 5 CDN -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <!-- âœ… PhotoSwipe 5 CDN (Lightbox) -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/photoswipe@5.4.4/dist/photoswipe.css">
  <style>
    :root{
      --ink:#0b2239; --bg:#f8fafc; --muted:#6b7280; --brand:#0d6efd;
    }
    body{background:var(--bg); color:var(--ink)}
    .gallery-grid{ 
      display:grid; 
      grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
      gap:14px; 
    }
    .g-card{position:relative; border-radius:16px; overflow:hidden; background:#fff; box-shadow:0 2px 10px rgba(0,0,0,.06)}
    .g-card img{width:100%; height:220px; object-fit:cover; display:block}
    .g-badge{position:absolute; left:10px; top:10px; backdrop-filter: blur(6px); background:rgba(0,0,0,.45); color:#fff; padding:4px 8px; border-radius:999px; font-size:.8rem}
    .g-title{font-weight:600; font-size:.95rem}
    .g-meta{color:var(--muted); font-size:.85rem}
    .pswp__caption__center{text-align:left}
    .tag-chip{cursor:pointer}
    .tag-chip.active{background:var(--brand); color:#fff}
    .sticky-top-controls{position:sticky; top:0; z-index:999; background:linear-gradient(#f8fafc 70%, rgba(248,250,252,0)); padding-top:10px}
  </style>
  <!--
  ä½¿ç”¨èªªæ˜ï¼š
  1) æŠŠåœ–ç‰‡æª”æ”¾åˆ° /assets/gallery/ åº•ä¸‹ï¼ˆå»ºè­°åŸåœ– + ç¸®åœ–å„ä¸€ï¼‰ã€‚
  2) åˆ°æœ€ä¸‹é¢çš„ GALLERY é™£åˆ—æ–°å¢é …ç›®ï¼š
     {
       id: "å”¯ä¸€ç·¨è™Ÿ",
       title: "åœ–ç‰‡æ¨™é¡Œ",
       src: "/assets/gallery/åŸåœ–.jpg",  // åŸå§‹å¤§åœ–ï¼ˆlightbox ç”¨ï¼‰
       w: 2000, h: 1333,                 // å¤§åœ–çš„åƒç´ å¯¬é«˜ï¼ˆåŠ é€Ÿé–‹å•Ÿï¼‰
       thumb: "/assets/gallery/thumbs/åŸåœ–-thumb.jpg", // ç¸®åœ–è·¯å¾‘
       tags: ["æ¾æ¹–","ä¸ƒç¾","æµ·æ™¯"],   // æ¨™ç±¤å¯å¤šå€‹
       note: "å¯åŠ è¨»è§£æˆ–ç‰ˆæ¬Š / ä¾†æº"
     }
  3) ç«™å…§æœå°‹èˆ‡æ¨™ç±¤æœƒè‡ªå‹•ç”Ÿæ•ˆï¼›é»ç¸®åœ–æœƒé–‹å•Ÿå…¨è¢å¹•ç‡ˆç®±ã€‚
  4) å¯ç›´æ¥ç”¨æ–¼ Jekyllï¼šå°‡æ­¤æª”å­˜æˆ gallery.html å¾Œï¼Œ
     åœ¨æª”é ­åŠ ä¸Š front matterï¼š
     ---\nlayout: default\ntitle: åœ–ç‰‡è³‡æ–™åº«\npermalink: /gallery/\n---
  -->
</head>
<body>
  <nav class="navbar navbar-expand-lg bg-white border-bottom shadow-sm">
    <div class="container">
      <a class="navbar-brand fw-bold" href="#">åœ–ç‰‡è³‡æ–™åº«</a>
      <div class="ms-auto small text-secondary">
        <span id="countAll">0</span> å¼µ Â· <span id="countVisible">0</span> å¯è¦‹
      </div>
    </div>
  </nav>

  <main class="container my-4">
    <section class="sticky-top-controls pb-2">
      <div class="row g-2 align-items-center">
        <div class="col-12 col-md-6">
          <div class="input-group input-group-lg">
            <span class="input-group-text bg-white">ğŸ”</span>
            <input id="q" class="form-control" placeholder="æœå°‹ï¼šæ¨™é¡Œã€æ¨™ç±¤ã€å‚™è¨»â€¦" />
            <button class="btn btn-outline-secondary" id="btnClear">æ¸…é™¤</button>
          </div>
        </div>
        <div class="col-6 col-md-3">
          <select id="selTag" class="form-select form-select-lg">
            <option value="">å…¨éƒ¨æ¨™ç±¤</option>
          </select>
        </div>
        <div class="col-6 col-md-3">
          <select id="selSort" class="form-select form-select-lg">
            <option value="new">æœ€æ–°åœ¨å‰</option>
            <option value="old">æœ€èˆŠåœ¨å‰</option>
            <option value="az">æ¨™é¡Œ Aâ†’Z</option>
            <option value="za">æ¨™é¡Œ Zâ†’A</option>
          </select>
        </div>
      </div>
      <div class="mt-2" id="tagChips"></div>
    </section>

    <section class="mt-3">
      <div id="grid" class="gallery-grid"></div>
    </section>
  </main>

  <!-- âœ… PhotoSwipe æ ¹ç¯€é» -->
  <div class="pswp" tabindex="-1" role="dialog" aria-hidden="true"></div>

  <!-- âœ… JSï¼šBootstrap / PhotoSwipe / è‡ªè¨‚é‚è¼¯ -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/photoswipe@5.4.4/dist/photoswipe.umd.min.js"></script>
  <script>
    // ===== ä½¿ç”¨è€…å¯ç·¨è¼¯ï¼šåœ–ç‰‡è³‡æ–™ =====
    const GALLERY = [
  // âœ… ç°¡å–®ç‰ˆï¼šåªå¯« srcã€titleã€tagsã€note
  { title: "æ©Ÿç¥¨åƒ¹æ ¼", src: "/assets/pic/t1.jpg", tags:["æ©Ÿç¥¨"] },
  { title: "åœ˜ä½“ç¥¨è¦å®š", src: "/assets/pic/t2.jpg", tags:["æ©Ÿç¥¨"] },
   { title: "2025é€£å‡", src: "/assets/pic/t3.jpg", tags:["æ©Ÿç¥¨"] },
  { title: "åŒ…å¥—åˆ†æï¼‘", src: "/assets/pic/w1.jpg", tags:["åŒ…å¥—"] },
  { title: "åŒ…å¥—åˆ†æï¼’", src: "/assets/pic/w2.jpg", tags:["åŒ…å¥—"] },
  { title: "2025æ¥å–®åˆ†æ515", src: "/assets/pic/2025/515-2025.jpg", tags:["2025æ¥å–®"] },
  { title: "2025æ¥å–®åˆ†æfish", src: "/assets/pic/2025/idlefish-2025.jpg", tags:["2025æ¥å–®"] },
  { title: "2025æ¥å–®åˆ†æ1", src: "/assets/pic/2025/52-2025.jpg", tags:["2025æ¥å–®"] },
];

    // ====== DOM å¿«é€Ÿé¸å– ======
    const $ = (sel, el=document) => el.querySelector(sel);
    const $$ = (sel, el=document) => Array.from(el.querySelectorAll(sel));

    const grid = $('#grid');
    const q = $('#q');
    const selTag = $('#selTag');
    const selSort = $('#selSort');
    const btnClear = $('#btnClear');
    const countAll = $('#countAll');
    const countVisible = $('#countVisible');
    const tagChips = $('#tagChips');

    // ====== ç‹€æ…‹ ======
    let state = { q:"", tag:"", sort:"new" };

    // ====== åˆå§‹åŒ– ======
    function init(){
      countAll.textContent = GALLERY.length;
      buildTagFilters();
      render();
      bindUI();
    }

    function buildTagFilters(){
      const tagSet = new Set();
      GALLERY.forEach(it => (it.tags||[]).forEach(t => tagSet.add(t)));
      // ä¸‹æ‹‰
      [...tagSet].sort().forEach(t=>{
        const opt = document.createElement('option');
        opt.value = t; opt.textContent = t;
        selTag.appendChild(opt);
      });
      // Chips
      const frag = document.createDocumentFragment();
      const makeChip = (text, value="")=>{
        const btn = document.createElement('button');
        btn.type='button';
        btn.className='btn btn-sm btn-outline-secondary me-2 mb-2 tag-chip';
        btn.dataset.value=value; btn.textContent=text;
        btn.addEventListener('click', ()=>{ selTag.value=value; state.tag=value; render(); highlightChips();});
        return btn;
      };
      frag.appendChild(makeChip('å…¨éƒ¨', ''));
      [...tagSet].sort().forEach(t=> frag.appendChild(makeChip(t, t)));
      tagChips.appendChild(frag);
      highlightChips();
    }

    function highlightChips(){
      $$('.tag-chip').forEach(b=> b.classList.toggle('active', b.dataset.value===state.tag));
    }

    function bindUI(){
      q.addEventListener('input', ()=>{ state.q = q.value.trim().toLowerCase(); render(); });
      selTag.addEventListener('change', ()=>{ state.tag = selTag.value; render(); highlightChips(); });
      selSort.addEventListener('change', ()=>{ state.sort = selSort.value; render(); });
      btnClear.addEventListener('click', ()=>{ q.value=''; state.q=''; render(); });
    }

    function filterList(list){
      const {q, tag} = state;
      return list.filter(it=>{
        const text = `${it.title||''} ${(it.tags||[]).join(' ')} ${it.note||''}`.toLowerCase();
        const qok = q? text.includes(q): true;
        const tok = tag? (it.tags||[]).includes(tag): true;
        return qok && tok;
      });
    }

    function sortList(list){
      const arr = [...list];
      switch(state.sort){
        case 'old': arr.reverse(); break; // åŸºæœ¬é è¨­ç‚ºä¸Šæ–¹è¼ƒæ–°
        case 'az': arr.sort((a,b)=> (a.title||'').localeCompare(b.title||'')); break;
        case 'za': arr.sort((a,b)=> (b.title||'').localeCompare(a.title||'')); break;
        case 'new': default: /* åŸé †åºè¦–ç‚ºæ–°åˆ°èˆŠ */ break;
      }
      return arr;
    }

    function render(){
      const view = sortList(filterList(GALLERY));
      countVisible.textContent = view.length;
      grid.innerHTML = '';
      const frag = document.createDocumentFragment();
      view.forEach((it, idx)=>{
        const a = document.createElement('a');
        a.href = it.src;
        a.setAttribute('data-pswp-width', it.w || 1600);
        a.setAttribute('data-pswp-height', it.h || 900);
        a.setAttribute('data-pswp-src', it.src);
        a.setAttribute('data-id', it.id || `it-${idx}`);
        a.className = 'g-card text-decoration-none text-reset';

        const badge = document.createElement('div');
        badge.className = 'g-badge';
        badge.textContent = (it.tags||[]).join(' Â· ');

        const img = document.createElement('img');
        img.loading='lazy';
        img.alt = it.title || '';
        img.src = it.thumb || it.src;

        const cap = document.createElement('div');
        cap.className = 'p-2';
        cap.innerHTML = `<div class="g-title">${escapeHtml(it.title||'ç„¡æ¨™é¡Œ')}</div>
                         <div class="g-meta">${escapeHtml(it.note||'')}</div>`;

        a.appendChild(img);
        a.appendChild(badge);
        a.appendChild(cap);
        frag.appendChild(a);
      });
      grid.appendChild(frag);
      buildLightbox();
    }

    function escapeHtml(str){
      return str.replace(/[&<>"']/g, s => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;','\'':'&#39;'}[s]));
    }

    let pswp;
    function buildLightbox(){
      if(pswp){ pswp.destroy(); pswp = null; }
      const items = $$('#grid a').map(a=>({
        src: a.getAttribute('data-pswp-src')||a.href,
        width: +a.getAttribute('data-pswp-width'),
        height: +a.getAttribute('data-pswp-height'),
        alt: $('img', a)?.alt || '',
        thumb: $('img', a)?.src || '',
        id: a.getAttribute('data-id')||''
      }));
      pswp = new PhotoSwipe({
        dataSource: items,
        bgOpacity: 0.95,
        wheelToZoom: true,
        padding: { top:20, bottom:40, left:20, right:20 },
        pswpModule: () => import('https://cdn.jsdelivr.net/npm/photoswipe@5.4.4/dist/photoswipe.esm.min.js')
      });
      // ä»¥å§”ä»»æ–¹å¼ï¼šé»æ“Šä»»ä¸€ç¸®åœ–é–‹å•Ÿç›¸ç°¿ä¸¦è·³åˆ°è©²å¼µ
      grid.addEventListener('click', (e)=>{
        const a = e.target.closest('a');
        if(!a) return;
        e.preventDefault();
        const idx = $$('#grid a').indexOf(a);
        if(idx>-1){ pswp.loadAndOpen(idx); }
      });
    }

    // å•Ÿå‹•
    init();
  </script>
</body>
</html>
